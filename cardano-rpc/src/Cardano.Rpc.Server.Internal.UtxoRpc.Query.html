<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Query.html"><span class="hs-identifier">Cardano.Rpc.Server.Internal.UtxoRpc.Query</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Query.html#readParamsMethod"><span class="hs-identifier">readParamsMethod</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Query.html#readUtxosMethod"><span class="hs-identifier">readUtxosMethod</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.html"><span class="hs-identifier">Cardano.Api</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Experimental.Era.html"><span class="hs-identifier">Cardano.Api.Experimental.Era</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Rpc.Proto.Api.UtxoRpc.Query.html"><span class="hs-identifier">Cardano.Rpc.Proto.Api.UtxoRpc.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UtxoRpc</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html"><span class="hs-identifier">Cardano.Rpc.Server.Internal.Error</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Monad.html"><span class="hs-identifier">Cardano.Rpc.Server.Internal.Monad</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Orphans.html"><span class="hs-identifier">Cardano.Rpc.Server.Internal.Orphans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Type.html"><span class="hs-identifier">Cardano.Rpc.Server.Internal.UtxoRpc.Type</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/rio-0.1.24.0-f91ce549d38c9e77bb8c4a5d41783ebcd8fb4154b4a25e82d16910d9820323f1/share/doc/html/src/RIO.html"><span class="hs-identifier">RIO</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Foldable.html#toList"><span class="hs-identifier">toList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/proto-lens-0.7.1.6-b539b912fa7850305251b61087e9879059bcaa8cf454d19572b90e9b465a3b4b/share/doc/html/src/Data.ProtoLens.html"><span class="hs-identifier">Data.ProtoLens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/proto-lens-0.7.1.6-b539b912fa7850305251b61087e9879059bcaa8cf454d19572b90e9b465a3b4b/share/doc/html/src/Data.ProtoLens.Message.html#defMessage"><span class="hs-identifier">defMessage</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/base-4.20.1.0-inplace/src/GHC.IsList.html"><span class="hs-identifier">GHC.IsList</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/grpc-spec-1.0.0-fc6fe90a677df2d1d92a99456ae551c0beec3935d0a4b58f17cd9480781282a3/share/doc/html/src/Network.GRPC.Spec.html"><span class="hs-identifier">Network.GRPC.Spec</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span id="local-6989586621679484415"><span id="local-6989586621679484416"><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Query.html#readParamsMethod"><span class="hs-identifier hs-type">readParamsMethod</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Monad.html#MonadRpc"><span class="hs-identifier hs-type">MonadRpc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484415"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484416"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/grpc-spec-1.0.0-fc6fe90a677df2d1d92a99456ae551c0beec3935d0a4b58f17cd9480781282a3/share/doc/html/src/Network.GRPC.Spec.RPC.Protobuf.html#Proto"><span class="hs-identifier hs-type">Proto</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UtxoRpc.ReadParamsRequest</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679484416"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/grpc-spec-1.0.0-fc6fe90a677df2d1d92a99456ae551c0beec3935d0a4b58f17cd9480781282a3/share/doc/html/src/Network.GRPC.Spec.RPC.Protobuf.html#Proto"><span class="hs-identifier hs-type">Proto</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UtxoRpc.ReadParamsResponse</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-37"></span><span id="readParamsMethod"><span class="annot"><span class="annottext">readParamsMethod :: forall e (m :: * -&gt; *).
MonadRpc e m =&gt;
Proto ReadParamsRequest -&gt; m (Proto ReadParamsResponse)
</span><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Query.html#readParamsMethod"><span class="hs-identifier hs-var hs-var">readParamsMethod</span></a></span></span><span> </span><span id="local-6989586621679484672"><span class="annot"><span class="annottext">Proto ReadParamsRequest
</span><a href="#local-6989586621679484672"><span class="hs-identifier hs-var">_req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- TODO: implement field masks - they are ignored for now</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- they need to be normalised beforehand, see: https://github.com/protocolbuffers/protobuf/blob/main/java/util/src/main/java/com/google/protobuf/util/FieldMaskTree.java#L76</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-comment">-- let fieldMask :: [Text] = req ^. #fieldMask . #paths</span><span>
</span><span id="line-41"></span><span>  </span><span id="local-6989586621679484673"><span class="annot"><a href="#local-6989586621679484673"><span class="hs-identifier hs-var">nodeConnInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m LocalNodeConnectInfo
forall field env (m :: * -&gt; *).
(Has field env, MonadReader env m) =&gt;
m field
</span><a href="Cardano.Rpc.Server.Internal.Monad.html#grab"><span class="hs-identifier hs-var">grab</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Era.Internal.Core.html#AnyCardanoEra"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679484773"><span class="annot"><a href="#local-6989586621679484773"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/base-4.20.1.0-inplace/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-type">liftIO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwExceptT"><span class="hs-identifier hs-type">throwExceptT</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Convenience.html#determineEra"><span class="hs-identifier hs-type">determineEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484673"><span class="hs-identifier hs-type">nodeConnInfo</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679484778"><span class="annot"><a href="#local-6989586621679484778"><span class="hs-identifier hs-var">eon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Era.Internal.Core.html#forEraInEon"><span class="hs-identifier hs-type">forEraInEon</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Experimental.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484773"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Err.html#error"><span class="hs-identifier hs-type">error</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Minimum Conway era required&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-type">pure</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679484781"><span class="annot"><a href="#local-6989586621679484781"><span class="hs-identifier hs-var hs-var">sbe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Era era -&gt; ShelleyBasedEra era
forall era. Era era -&gt; ShelleyBasedEra era
forall a (f :: a -&gt; *) (g :: a -&gt; *) (era :: a).
Convert f g =&gt;
f era -&gt; g era
</span><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Era.Internal.Eon.Convert.html#convert"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="annot"><span class="annottext">Era era
</span><a href="#local-6989586621679484778"><span class="hs-identifier hs-var">eon</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679484783"><span class="annot"><a href="#local-6989586621679484783"><span class="hs-identifier hs-var hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Target point
forall point. Target point
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/ouroboros-network-protocols-0.15.0.0-f984403bdd35b42d821425c4abf0359c34b0514290cc81c78f9017775ea69747/share/doc/html/src/Ouroboros.Network.Protocol.LocalStateQuery.Type.html#VolatileTip"><span class="hs-identifier hs-var">VolatileTip</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679484785"><span class="annot"><a href="#local-6989586621679484785"><span class="hs-identifier hs-var">pparams</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679484786"><span class="annot"><a href="#local-6989586621679484786"><span class="hs-identifier hs-var">chainPoint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679484787"><span class="annot"><a href="#local-6989586621679484787"><span class="hs-identifier hs-var">blockNo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/base-4.20.1.0-inplace/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-type">liftIO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwEither</span></span><span> </span><span class="annot"><span class="hs-operator">=&lt;&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Network.IPC.Internal.Monad.html#executeLocalStateQueryExpr"><span class="hs-identifier hs-type">executeLocalStateQueryExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484673"><span class="hs-identifier hs-type">nodeConnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484783"><span class="hs-identifier hs-type">target</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-48"></span><span>    </span><span id="local-6989586621679484791"><span class="annot"><a href="#local-6989586621679484791"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Expr.html#queryProtocolParameters"><span class="hs-identifier hs-type">queryProtocolParameters</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484781"><span class="hs-identifier hs-type">sbe</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679484793"><span class="annot"><a href="#local-6989586621679484793"><span class="hs-identifier hs-var">chainPoint</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Expr.html#queryChainPoint"><span class="hs-identifier hs-type">queryChainPoint</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679484795"><span class="annot"><a href="#local-6989586621679484795"><span class="hs-identifier hs-var">blockNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Expr.html#queryChainBlockNo"><span class="hs-identifier hs-type">queryChainBlockNo</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-type">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679484791"><span class="hs-identifier hs-type">pparams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679484793"><span class="hs-identifier hs-type">chainPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679484795"><span class="hs-identifier hs-type">blockNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-type">pure</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">def</span></span><span>
</span><span id="line-55"></span><span>      </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Function.html#%26"><span class="hs-operator hs-type">&amp;</span></a></span><span> </span><span class="annot"><span class="">#ledgerTip</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.~</span></span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Type.html#mkChainPointMsg"><span class="hs-identifier hs-type">mkChainPointMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484786"><span class="hs-identifier hs-type">chainPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484787"><span class="hs-identifier hs-type">blockNo</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Function.html#%26"><span class="hs-operator hs-type">&amp;</span></a></span><span> </span><span class="annot"><span class="">#values</span></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><span class="">#cardano</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Experimental.Era.html#obtainCommonConstraints"><span class="hs-identifier hs-type">obtainCommonConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484778"><span class="hs-identifier hs-type">eon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Type.html#protocolParamsToUtxoRpcPParams"><span class="hs-identifier hs-type">protocolParamsToUtxoRpcPParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484778"><span class="hs-identifier hs-type">eon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484785"><span class="hs-identifier hs-type">pparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span id="local-6989586621679484583"><span id="local-6989586621679484584"><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Query.html#readUtxosMethod"><span class="hs-identifier hs-type">readUtxosMethod</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Monad.html#MonadRpc"><span class="hs-identifier hs-type">MonadRpc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484583"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484584"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/grpc-spec-1.0.0-fc6fe90a677df2d1d92a99456ae551c0beec3935d0a4b58f17cd9480781282a3/share/doc/html/src/Network.GRPC.Spec.RPC.Protobuf.html#Proto"><span class="hs-identifier hs-type">Proto</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UtxoRpc.ReadUtxosRequest</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679484584"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/grpc-spec-1.0.0-fc6fe90a677df2d1d92a99456ae551c0beec3935d0a4b58f17cd9480781282a3/share/doc/html/src/Network.GRPC.Spec.RPC.Protobuf.html#Proto"><span class="hs-identifier hs-type">Proto</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UtxoRpc.ReadUtxosResponse</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-62"></span><span id="readUtxosMethod"><span class="annot"><span class="annottext">readUtxosMethod :: forall e (m :: * -&gt; *).
MonadRpc e m =&gt;
Proto ReadUtxosRequest -&gt; m (Proto ReadUtxosResponse)
</span><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Query.html#readUtxosMethod"><span class="hs-identifier hs-var hs-var">readUtxosMethod</span></a></span></span><span> </span><span id="local-6989586621679484866"><span class="annot"><span class="annottext">Proto ReadUtxosRequest
</span><a href="#local-6989586621679484866"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679484867"><span class="annot"><a href="#local-6989586621679484867"><span class="hs-identifier hs-var">utxoFilter</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-prim-0.12.0-inplace/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Proto TxoRef] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([Proto TxoRef] -&gt; Bool) -&gt; [Proto TxoRef] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proto ReadUtxosRequest
</span><a href="#local-6989586621679484866"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Proto ReadUtxosRequest
-&gt; Getting [Proto TxoRef] (Proto ReadUtxosRequest) [Proto TxoRef]
-&gt; [Proto TxoRef]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [Proto TxoRef] (Proto ReadUtxosRequest) [Proto TxoRef]
</span><span class="">#keys</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Set TxIn -&gt; QueryUTxOFilter
</span><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Type.QueryInMode.html#QueryUTxOByTxIn"><span class="hs-identifier hs-var">QueryUTxOByTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">(Set TxIn -&gt; QueryUTxOFilter)
-&gt; ([TxIn] -&gt; Set TxIn) -&gt; [TxIn] -&gt; QueryUTxOFilter
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Item (Set TxIn)] -&gt; Set TxIn
[TxIn] -&gt; Set TxIn
forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.IsList.html#fromList"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([TxIn] -&gt; QueryUTxOFilter) -&gt; m [TxIn] -&gt; m QueryUTxOFilter
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Proto TxoRef -&gt; m TxIn) -&gt; [Proto TxoRef] -&gt; m [TxIn]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Proto TxoRef -&gt; m TxIn
forall e (m :: * -&gt; *). MonadRpc e m =&gt; Proto TxoRef -&gt; m TxIn
</span><a href="#local-6989586621679484874"><span class="hs-identifier hs-var">txoRefToTxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proto ReadUtxosRequest
</span><a href="#local-6989586621679484866"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Proto ReadUtxosRequest
-&gt; Getting [Proto TxoRef] (Proto ReadUtxosRequest) [Proto TxoRef]
-&gt; [Proto TxoRef]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [Proto TxoRef] (Proto ReadUtxosRequest) [Proto TxoRef]
</span><span class="">#keys</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>      </span><span class="hs-comment">-- TODO: reimplement this part as SearchUtxosRequest</span><span>
</span><span id="line-67"></span><span>      </span><span class="hs-comment">-- \| Just addressesProto &lt;- req ^. #maybe'cardanoAddresses -&gt;</span><span>
</span><span id="line-68"></span><span>      </span><span class="hs-comment">--     QueryUTxOByAddress . fromList &lt;$&gt; mapM readAddress (addressesProto ^. #items)</span><span>
</span><span id="line-69"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">QueryUTxOFilter -&gt; m QueryUTxOFilter
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">QueryUTxOFilter
</span><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Type.QueryInMode.html#QueryUTxOWhole"><span class="hs-identifier hs-var">QueryUTxOWhole</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679484876"><span class="annot"><a href="#local-6989586621679484876"><span class="hs-identifier hs-var">nodeConnInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Monad.html#grab"><span class="hs-identifier hs-type">grab</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Era.Internal.Core.html#AnyCardanoEra"><span class="hs-identifier hs-type">AnyCardanoEra</span></a></span><span> </span><span id="local-6989586621679484950"><span class="annot"><a href="#local-6989586621679484950"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/base-4.20.1.0-inplace/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-type">liftIO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwExceptT"><span class="hs-identifier hs-type">throwExceptT</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Convenience.html#determineEra"><span class="hs-identifier hs-type">determineEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484876"><span class="hs-identifier hs-type">nodeConnInfo</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679484951"><span class="annot"><a href="#local-6989586621679484951"><span class="hs-identifier hs-var">eon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Era.Internal.Core.html#forEraInEon"><span class="hs-identifier hs-type">forEraInEon</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Experimental.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484950"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Err.html#error"><span class="hs-identifier hs-type">error</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Minimum Conway era required&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-type">pure</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679484952"><span class="annot"><a href="#local-6989586621679484952"><span class="hs-identifier hs-var hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Target point
forall point. Target point
</span><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/ouroboros-network-protocols-0.15.0.0-f984403bdd35b42d821425c4abf0359c34b0514290cc81c78f9017775ea69747/share/doc/html/src/Ouroboros.Network.Protocol.LocalStateQuery.Type.html#VolatileTip"><span class="hs-identifier hs-var">VolatileTip</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679484953"><span class="annot"><a href="#local-6989586621679484953"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679484954"><span class="annot"><a href="#local-6989586621679484954"><span class="hs-identifier hs-var">chainPoint</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679484955"><span class="annot"><a href="#local-6989586621679484955"><span class="hs-identifier hs-var">blockNo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/base-4.20.1.0-inplace/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-type">liftIO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwEither</span></span><span> </span><span class="annot"><span class="hs-operator">=&lt;&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Network.IPC.Internal.Monad.html#executeLocalStateQueryExpr"><span class="hs-identifier hs-type">executeLocalStateQueryExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484876"><span class="hs-identifier hs-type">nodeConnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484952"><span class="hs-identifier hs-type">target</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679484956"><span class="annot"><a href="#local-6989586621679484956"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Expr.html#queryUtxo"><span class="hs-identifier hs-type">queryUtxo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Era.Internal.Eon.Convert.html#convert"><span class="hs-identifier hs-type">convert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484951"><span class="hs-identifier hs-type">eon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679484867"><span class="hs-identifier hs-type">utxoFilter</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679484958"><span class="annot"><a href="#local-6989586621679484958"><span class="hs-identifier hs-var">chainPoint</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Expr.html#queryChainPoint"><span class="hs-identifier hs-type">queryChainPoint</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679484959"><span class="annot"><a href="#local-6989586621679484959"><span class="hs-identifier hs-var">blockNo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-type">throwEither</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%3D%3C%3C"><span class="hs-operator hs-type">=&lt;&lt;</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Query.Internal.Expr.html#queryChainBlockNo"><span class="hs-identifier hs-type">queryChainBlockNo</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-type">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679484956"><span class="hs-identifier hs-type">utxo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679484958"><span class="hs-identifier hs-type">chainPoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679484959"><span class="hs-identifier hs-type">blockNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-type">pure</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/proto-lens-0.7.1.6-b539b912fa7850305251b61087e9879059bcaa8cf454d19572b90e9b465a3b4b/share/doc/html/src/Data.ProtoLens.Message.html#defMessage"><span class="hs-identifier hs-type">defMessage</span></a></span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Function.html#%26"><span class="hs-operator hs-type">&amp;</span></a></span><span> </span><span class="annot"><span class="">#ledgerTip</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.~</span></span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Type.html#mkChainPointMsg"><span class="hs-identifier hs-type">mkChainPointMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484954"><span class="hs-identifier hs-type">chainPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484955"><span class="hs-identifier hs-type">blockNo</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Data.Function.html#%26"><span class="hs-operator hs-type">&amp;</span></a></span><span> </span><span class="annot"><span class="">#items</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Experimental.Era.html#obtainCommonConstraints"><span class="hs-identifier hs-type">obtainCommonConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484951"><span class="hs-identifier hs-type">eon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Rpc.Server.Internal.UtxoRpc.Type.html#utxoToUtxoRpcAnyUtxoData"><span class="hs-identifier hs-type">utxoToUtxoRpcAnyUtxoData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484953"><span class="hs-identifier hs-type">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679484614"><span id="local-6989586621679484615"><span class="annot"><a href="#local-6989586621679484874"><span class="hs-identifier hs-type">txoRefToTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Rpc.Server.Internal.Monad.html#MonadRpc"><span class="hs-identifier hs-type">MonadRpc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484614"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679484615"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.local/state/cabal/store/ghc-9.10.2-inplace/grpc-spec-1.0.0-fc6fe90a677df2d1d92a99456ae551c0beec3935d0a4b58f17cd9480781282a3/share/doc/html/src/Network.GRPC.Spec.RPC.Protobuf.html#Proto"><span class="hs-identifier hs-type">Proto</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UtxoRpc.TxoRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679484615"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Tx.Internal.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span></span></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679484874"><span class="annot"><span class="annottext">txoRefToTxIn :: forall e (m :: * -&gt; *). MonadRpc e m =&gt; Proto TxoRef -&gt; m TxIn
</span><a href="#local-6989586621679484874"><span class="hs-identifier hs-var hs-var">txoRefToTxIn</span></a></span></span><span> </span><span id="local-6989586621679485008"><span class="annot"><span class="annottext">Proto TxoRef
</span><a href="#local-6989586621679485008"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679485009"><span class="annot"><a href="#local-6989586621679485009"><span class="hs-identifier hs-var">txId'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either SerialiseAsRawBytesError TxId -&gt; m TxId
forall e (m :: * -&gt; *) a.
(Error e, HasCallStack, MonadIO m, Show e, Typeable e) =&gt;
Either e a -&gt; m a
</span><a href="Cardano.Rpc.Server.Internal.Error.html#throwEither"><span class="hs-identifier hs-var">throwEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either SerialiseAsRawBytesError TxId -&gt; m TxId)
-&gt; Either SerialiseAsRawBytesError TxId -&gt; m TxId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AsType TxId -&gt; ByteString -&gt; Either SerialiseAsRawBytesError TxId
forall a.
SerialiseAsRawBytes a =&gt;
AsType a -&gt; ByteString -&gt; Either SerialiseAsRawBytesError a
</span><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Serialise.Raw.html#deserialiseFromRawBytes"><span class="hs-identifier hs-var">deserialiseFromRawBytes</span></a></span><span> </span><span class="annot"><span class="annottext">AsType TxId
</span><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Tx.Internal.TxIn.html#AsTxId"><span class="hs-identifier hs-var">AsTxId</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either SerialiseAsRawBytesError TxId)
-&gt; ByteString -&gt; Either SerialiseAsRawBytesError TxId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proto TxoRef
</span><a href="#local-6989586621679485008"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Proto TxoRef
-&gt; Getting ByteString (Proto TxoRef) ByteString -&gt; ByteString
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ByteString (Proto TxoRef) ByteString
</span><span class="">#hash</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#pure"><span class="hs-identifier hs-type">pure</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Tx.Internal.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679485009"><span class="hs-identifier hs-type">txId'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/cardano-api/cardano-api/dist-newstyle/build/x86_64-linux/ghc-9.10.2/cardano-api-10.23.0.0/doc/html/cardano-api/src/Cardano.Api.Tx.Internal.TxIn.html#TxIx"><span class="hs-identifier hs-type">TxIx</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Real.html#fromIntegral"><span class="hs-identifier hs-type">fromIntegral</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/kpki8kp9j72vc53734k9s5v4zrr9fkk3-ghc-9.10.2-doc/share/doc/ghc-9.10.2/html/libraries/ghc-internal-9.1002.0-inplace/src/GHC.Internal.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679485008"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="">#index</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- TODO: reimplement this part as SearchUtxosRequest</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- readAddress :: MonadRpc e m =&gt; ByteString -&gt; m AddressAny</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- readAddress =</span><span>
</span><span id="line-95"></span><span class="hs-comment">--   throwEither . first stringException . P.runParser parseAddressAny &lt;=&lt; throwEither . T.decodeUtf8'</span><span>
</span><span id="line-96"></span></pre></body></html>